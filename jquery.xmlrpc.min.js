(function(i){"use strict";var q=function(){Error.apply(this,arguments)};q.prototype=new Error();q.prototype.type='XML-RPC fault';var c=i.xmlrpc=function(a,b){if(arguments.length==2){b.url=a}else{b=a;a=b.url}b.dataType='xml json';b.type='POST';b.contentType='text/xml';b.converters={'xml json':c.parseDocument};var d=c.document(b.methodName,b.params);var f=new XMLSerializer();b.data=f.serializeToString(d);return i.ajax(b)};c.document=function(d,f){var g=document.implementation.createDocument(null,null,null);var e=function(a){return i(g.createElement(a))};var j=e('methodName').text(d);var h=e('params').append(i.map(f,function(a){var b=e('value').append(c.toXmlRpc(a,e));return e('param').append(b)}));var k=e('methodCall').append(j,h);g.appendChild(k.get(0));return g};var s=function(a){return(a===parseInt(a,10))&&!isNaN(a)};c.toXmlRpc=function(a,b){if(a instanceof r)return a.toXmlRpc(b);var d=i.xmlrpc.types;var f=i.type(a);switch(f){case"undefined":case"null":return d.nil.encode(a,b);case"date":return d['date.iso8601'].encode(a,b);case"object":if(a instanceof ArrayBuffer){return d.base64.encode(a,b)}else{return d.struct.encode(a,b)}break;case"number":if(s(a)){return d['int'].encode(a,b)}else{return d['double'].encode(a,b)}break;case"array":case"boolean":case"string":return d[f].encode(a,b);default:throw new Error("Unknown type",a);}};c.parseDocument=function(a){var b=i(a);var d=b.children('methodresponse');var f;var g=d.find('> fault');if(g.length===0){var e=d.find('> params > param > value > *');var j=e.toArray().map(c.parseNode);return j}else{var h=c.parseNode(g.find('> value > *').get(0));var k=new q(h.faultString);k.msg=k.message=h.faultString;k.type=k.code=h.faultCode;throw k;}};c.parseNode=function(a){if(a===undefined){return null}var b=a.nodeName.toLowerCase();if(b in c.types){return c.types[b].decode(a)}else{throw new Error('Unknown type '+b);}};c.parseValue=function(a){var b=i(a).children()[0];if(b){return c.parseNode(b)}else{return i(a).text()}};var r=function(){};i.xmlrpc.types={};c.makeType=function(f,g,e,j){var h;h=function(a){this.value=a};h.prototype=new r();h.prototype.tagName=f;if(g){var k=e,l=j;e=function(a,b){var d=k(a);return b(h.tagName).text(d)};j=function(a){return l(i(a).text(),a)}}h.prototype.toXmlRpc=function(a){return h.encode(this.value,a)};h.tagName=f;h.encode=e;h.decode=j;c.types[f]=h};var m=function(a){return''+Math.floor(a)};var n=function(a,b){return parseInt(a,10)};c.makeType('int',true,m,n),c.makeType('i4',true,m,n),c.makeType('i8',true,m,n),c.makeType('i16',true,m,n),c.makeType('i32',true,m,n),c.makeType('double',true,String,function(a){return parseFloat(a,10)});c.makeType('string',true,String,String);c.makeType('boolean',true,function(a){return a?'1':'0'},function(a){return a=='1'});var o=function(a){return a<10?'0'+a:a};c.makeType('date.iso8601',true,function(a){return[a.getUTCFullYear(),'-',o(a.getUTCMonth()+1),'-',o(a.getUTCDate()),'T',o(a.getUTCHours()),':',o(a.getUTCMinutes()),':',o(a.getUTCSeconds()),'Z'].join('')},function(a){return new Date(a)});c.binary=(function(){var k='=';var l=('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/').split("");var p=l.reduce(function(a,b,d){a[b]=d;return a},{});return{toBase64:function(a){var b=[];var d=new Uint8Array(a);var f=0,g;for(;f>18)%64]);b.push(l[(g>>12)%64]);b.push(l[(g>>6)%64]);b.push(l[(g>>0)%64])}var e=3-((a.byteLength%3)||3);while(e--){b[b.length-e-1]=k}return b.join('')},fromBase64:function(a){var b=a.length;var d=(b/4)*3;if(a.charAt(b-1)==k)d--;if(a.charAt(b-2)==k)d--;var f=new ArrayBuffer(d);var g=new Uint8Array(f);var e=0,j=0,h;for(;e>16)%256;g[j+1]=(h>>8)%256;g[j+2]=(h>>0)%256}return f}}})();c.makeType('base64',true,function(a){return c.binary.toBase64(a)},function(a){return c.binary.fromBase64(a)});c.makeType('nil',false,function(a,b){return b('nil')},function(a){return null});c.makeType('struct',false,function(g,e){var j=e('struct');i.each(g,function(a,b){var d=e('name').text(a);var f=e('value').append(c.toXmlRpc(b,e));j.append(e('member').append(d,f))});return j},function(e){return i(e).find('> member').toArray().reduce(function(a,b){var d=i(b);var f=d.find('> name').text();var g=c.parseValue(d.find('> value'));a[f]=g;return a},{})});c.makeType('array',false,function(d,f){var g=f('array');var e=f('data');i.each(d,function(a,b){e.append(f('value').append(c.toXmlRpc(b,f)))});g.append(e);return g},function(a){return i(a).find('> data > value').toArray().map(c.parseValue)});c.force=function(a,b){return new c.types[a](b)}})(jQuery);